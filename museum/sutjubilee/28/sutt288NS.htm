<!-- HTML Header -->
<HTML>
<!--
 	Set up the applet for event routing

<!-- 	Created using Windows Media Author software to create slideshows  -->
<!-- 	The code generated by Author is copyrighted and co-developed between -->
<!-- 	Microsoft and Digital Renaissance, Toronto, Canada - 1999 -->

<!--	The Applet code below can be used to implement a applet capable of -->
<!-- 	showing captions and marquee integrted into the page  ( versus a 	 -->
<!-- 	standard FORM text box. Uncomment the applet defintion if -->
<!-- 	desired -->

<!--<APPLET NAME="JMarquee" CODE="JMarquee.class" WIDTH=200 HEIGHT=50 IGNORE="">-->
<!--<PARAM NAME = "width"  VALUE = "200" >-->
<!--<PARAM NAME = "height" VALUE = "50" >-->
<!--</APPLET> -->

<!-- Microsoft Windows Media Player object -->
<CENTER><FONT FACE="Verdana,Arial,Helvetica" size=2 COLOR="#ff3300">
<B>
<a href="http://www.microsoft.com/windowsmedia">Creating streaming media using Windows Media Technologies</a><BR>
using<BR><a href="http://tag.digital-ren.com">Windows Media Author</a></FONT>
<BR>
<BR>

<Applet MAYSCRIPT Code="NPDS.npDSEvtObsProxy.class" Width=5 Height=5
Name="appObs" ></Applet>

<!-- NetShow Player object -->
<CENTER>
<Embed type="application/x-mplayer2" 
        pluginspage="http://www.microsoft.com/windows/mediaplayer/download/default.asp" 
	FileName="sutt288.asf" 
	Name=Player1	
	width=320
	height=305
	SHOWCONTROLS=-1 AUTOSIZE=0
	SHOWGOTOBAR=-1
	INVOKEURLS=-1 AUTOSTART=1 CLICKTOPLAY=0>
</embed>
</OBJECT>
</CENTER><BR>

</BODY>
<h1>
</BODY>
</HTML>

<SCRIPT LANGUAGE="JAVAScript">
if (navigator.appName.indexOf("Microsoft Internet Explorer") !=0) 
	{
//	alert ("Don't forget to uncomment the applet tag on the html page otherwise you will get a 'document.appObs has no properties.' error");
	var pluginJavaPeerRef = document.Player1;
	document.appObs.setByProxySelectedEvents(pluginJavaPeerRef, 1048575);
	navigator.plugins.refresh();
	}


//var pluginJavaPeerRef = document.Player1;
// Set up all events to be triggered 

//	document.appObs.setByProxyDSScriptCommandObserver(pluginJavaPeerRef, true);
//	document.appObs.setByProxyDSMarkerHitObserver(pluginJavaPeerRef, true);

// Set up the Script command event parser ..

function OnDSScriptCommandEvt(type, param)
{

  var event = type.toUpperCase();

  if ( event == "CAPTION" ) { change(param);}
  if ( event == "URL" ) {  
	if (!document.Player1.GetInvokeURLs() ) {
		Launch_Url( param);  }
			}
  if ( event == "FILENAME" ) {  
	if (!document.Player1.GetInvokeURLs() ) {
		Launch_Url( param); } 
			}

}

</SCRIPT>

<SCRIPT LANGUAGE="JavaScript">
/********************  JavaScript header, variable declarations  *********************/

var strDelim
var strAnnotation
var strBehaviour    

</SCRIPT>
<HTML>

<!-- Implement the caption area -->
<CENTER>
<FORM NAME="Caption">
<FONT SIZE=3  FACE="arial">
<TEXTAREA ROWS=5 COLS=27 NAME="textbox"></TEXTAREA>
</FONT>
</FORM>
</CENTER>

</HTML>
<SCRIPT LANGUAGE="JavaScript">


//
// Change the caption value
//

// The following function has been commented out and belongs with the JMarquee applet

//function change(cValue) {
//  document.JMarquee.setCaption( cValue );
//  document.JMarquee.setMarquee( 0);
//  document.JMarquee.activate();
//}

// The following function implements the change in the caption area.

function change(cValue)	
		{
	document.Caption.textbox.value=cValue;
		}


</SCRIPT>
<SCRIPT LANGUAGE="JavaScript">
var strDelim
var strAnnotation
var strBehaviour
var framenames	= new Array(50)

	strAnnotation ="";
	strBehaviour ="";
	strDelim = "{";

if (navigator.appName.indexOf("Microsoft Internet Explorer") == 0) 
	{

	/* If IE 4 then Go through all the frames and store it in an array */

	if ((navigator.appName.indexOf("Microsoft Internet Explorer") == 0) && (navigator.appVersion.indexOf("4.") == 0))
		{
		var i = parent.frames.length;
		for (var i=0;i<window.parent.frames.length;i++)
		{
		framenames[i]=window.parent.frames(i).name;
		}
	}
}
	

/******************* Launch URL Script **********************/

function Launch_Url( bstrParam )
{
	var i = 0;
	var tempParam = bstrParam;
	if( bstrParam.indexOf( "&&") < 0 ) 	// if there is no target frame, use the default
		{tempParam = bstrParam+"&&"+"%FRAMENAME%";}

	strAnnotation = GrabfromParam(tempParam,1,"&&",2);
	ftargetframe = GrabfromParam(tempParam,2,"&&",2);
	i = parent.frames.length;
	
	while( i > 0)	
		{
		
		if ((navigator.appName.indexOf("Microsoft Internet Explorer") == 0) && (navigator.appVersion.indexOf("4.") == 0))
			{
			if (eval('framenames[i-1]') == ftargetframe)
			{
				eval('parent.'+framenames[i-1]+'.location = strAnnotation'); 		
				i = 0; }			
			}
		else 
			{ // Netscape 3 & 4

			if (navigator.appName.indexOf("Microsoft Internet Explorer") !=0)
				{
				document.DSPlay.LaunchURL(tempParam);
				}
			else
				{ // IE 3
				if (parent.frames[i-1].window.name == ftargetframe)	
					{
					parent.frames[i-1].window.location = strAnnotation;
					i = 0; 
					}
				}
			} 
		i= i-1;	
	}
}


/************************************************************************
 *  JavaScript footer / common functions
 ************************************************************************/

//<-----/// Parse Script Command Parameter ///----->

function GrabfromParam(strParam,intPosition,sdelim,ilen)
{
 	strElement = strParam;
	
	//only left trunc if intPosition > 1
	if( intPosition > 1 ) {
		for( var i = 2; i <= intPosition; i++ ) {
			//truncate left until at the correct position
			if (navigator.userAgent.indexOf("Mozilla") > -1 && (navigator.userAgent.indexOf("3.") > -1 || navigator.userAgent.indexOf("4.") > -1) && navigator.userAgent.indexOf("MSIE") == -1)
					{strElement = strElement.substring( strElement.indexOf(sdelim)+ilen, strElement.length() );}
				else	
					{strElement = strElement.substring( strElement.indexOf(sdelim)+ilen, strElement.length );}
		}
	}

	//it's at the correct position
	//if there is still another delimiter, truncate right

	if( strElement.indexOf( sdelim ) > 0 ) {
		strElement = strElement.substring( 0, strElement.indexOf(sdelim) );
	}

	return strElement;
}


// end of JavaScript footer / common functions
</SCRIPT>
